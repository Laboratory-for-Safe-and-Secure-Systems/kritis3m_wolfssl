#ifndef _USER_SETTINGS_H_
#define _USER_SETTINGS_H_

#ifdef __cplusplus
extern "C" {
#endif


/* Feature support */
#define WOLFSSL_TLS13
// #define WOLFSSL_USER_IO
#define WOLF_CRYPTO_CB
#define HAVE_TLS_EXTENSIONS
#define HAVE_SUPPORTED_CURVES
#define HAVE_NULL_CIPHER
#define HAVE_SECRET_CALLBACK
#define HAVE_WOLF_BIGINT
#define HAVE_PKCS11
// #define HAVE_PKCS11_STATIC
// #define HAVE_PKCS11_STATIC_V3
#define WOLFSSL_DUAL_ALG_CERTS
#define WOLFSSL_ASN_TEMPLATE
#define LARGE_STATIC_BUFFERS
#define WOLFSSL_ALT_NAMES
#define WOLFSSL_IP_ALT_NAME
#define WC_CTC_MAX_ALT_SIZE 512

#define WOLFSSL_KEY_GEN
#define WOLFSSL_CERT_GEN
#define WOLFSSL_CERT_REQ
#define WOLFSSL_CERT_EXT
#define WC_ENABLE_ASYM_KEY_EXPORT

#define NO_PWDBASED
#define NO_WRITEV
#define NO_DEV_URANDOM
#define NO_MULTIBYTE_PRINT
#define NO_OLD_TLS
#define WOLFSSL_NO_TLS12
#define NO_OLD_RNGNAME
// #define NO_PKCS11_ECDH
// #define NO_PKCS11_EC_KEYGEN


/* Enable experimental features */
#define WOLFSSL_EXPERIMENTAL_SETTINGS


/* Algorithm support and configuration */
#define WC_RNG_BLOCKING
#define HAVE_ECC
#define HAVE_ECC384
#define HAVE_ECC521
#define ECC_SHAMIR
#define ECC_TIMING_RESISTANT
#define HAVE_CURVE25519
#define HAVE_ED25519
#define HAVE_ED25519_KEY_EXPORT
#define HAVE_CURVE448
#define HAVE_ED448
#define HAVE_ED448_KEY_EXPORT
#define WC_RSA_PSS
#define WC_RSA_BLINDING
#define WC_RSA_DIRECT
#define WOLF_CRYPTO_CB_RSA_PAD
#define WOLFSSL_RSA_KEY_CHECK
#define WOLFSSL_SHA384
#define WOLFSSL_SHA512
#define WOLFSSL_SHA3
#define WOLFSSL_SHAKE128
#define WOLFSSL_SHAKE256
#define HAVE_HKDF
#define HAVE_AESGCM
#define GCM_TABLE_4BIT
#define WOLFSSL_HAVE_KYBER
#define WOLFSSL_WC_KYBER
#define WOLFSSL_KYBER_ORIGINAL
#define HAVE_DILITHIUM
#define WOLFSSL_WC_DILITHIUM
#define WOLFSSL_DILITHIUM_FIPS204_DRAFT


// #define WOLFSSL_HAVE_LMS
// #define WOLFSSL_WC_LMS
// #define WOLFSSL_LMS_VERIFY_ONLY

// #define WOLFSSL_HAVE_XMSS
// #define WOLFSSL_WC_XMSS

#define WC_DILITHIUM_CACHE_MATRIX_A
#define WC_DILITHIUM_CACHE_PRIV_VECTORS
#define WC_DILITHIUM_CACHE_PUB_VECTORS

/* Liboqs FALCON support */
#cmakedefine KRITIS3M_WOLFSSL_ENABLE_FALCON

#if defined(KRITIS3M_WOLFSSL_ENABLE_FALCON)

#define HAVE_LIBOQS

#endif


#define NO_MD4
#define NO_MD5
#define NO_DES3
#define NO_DSA
#define NO_DH
#define NO_RC4
#define NO_AES_192
#define WOLFSSL_NO_SPHINCS


/* Debugging */
#define DEBUG_WOLFSSL
#define WOLFSSL_MAX_ERROR_SZ 224
// #define WOLFSSL_DEBUG_PKCS11
// #define WOLFSSL_DEBUG_MEMORY
// #define WOLFSSL_DEBUG_MEMORY_PRINT


/* Math configuration */
#define WOLFSSL_SP_MATH
#define WOLFSSL_SP_MATH_ALL
#define WOLFSSL_HAVE_SP_ECC
#define WOLFSSL_HAVE_SP_DH
#define WOLFSSL_HAVE_SP_RSA
#define WOLFSSL_SP_4096
#define WOLFSSL_SP_384
#define WOLFSSL_SP_521

#cmakedefine KRITIS3M_WOLFSSL_ASM

#if defined(__x86_64__) && defined(KRITIS3M_WOLFSSL_ASM)

#define WOLFSSL_SP_ASM
#define WOLFSSL_SP_X86_64
#define WOLFSSL_SP_X86_64_ASM
#define WOLFSSL_AESNI
#define WOLFSSL_X86_64_BUILD
#define USE_INTEL_SPEEDUP

#elif defined(__aarch64__) && defined(KRITIS3M_WOLFSSL_ASM)

#define WOLFSSL_SP_ASM
#define WOLFSSL_ARMASM
#define WOLFSSL_SP_ARM64
#define WOLFSSL_SP_ARM64_ASM
// #define WOLFSSL_ARMASM_NO_HW_CRYPTO
// #define WOLFSSL_AARCH64_NO_SQRMLSH

#endif

#ifdef __cplusplus
}
#endif

#endif /* _USER_SETTINGS_H_ */
